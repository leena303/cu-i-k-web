<app-header></app-header>

<div class="container py-4">
  <div class="intro-section mb-4 text-center">
    <h1>Chi tiết sản phẩm</h1>
  </div>

  <div class="row justify-content-center">
    <!-- Cột trái: ảnh sản phẩm -->
    <div class="col-md-6 position-relative text-center">
      <!-- Nút Trước -->
      <button class="carousel-control-prev" type="button" (click)="prevImage()" [disabled]="productImages.length < 2">
        <span class="carousel-control-prev-icon"></span>
        <span class="visually-hidden">Trước</span>
      </button>

      <!-- Ảnh lớn -->
      <img *ngIf="selectedImage" [src]="selectedImage" (error)="selectedImage = product.getDefaultImage()"
        class="img-fluid rounded product-image mb-3" alt="Ảnh sản phẩm"
        style="max-width:100%;max-height:350px;object-fit:contain;">

      <!-- Nút Tiếp -->
      <button class="carousel-control-next" type="button" (click)="nextImage()" [disabled]="productImages.length < 2">
        <span class="carousel-control-next-icon"></span>
        <span class="visually-hidden">Tiếp</span>
      </button>

      <!-- Ảnh thumbnail -->
      <div class="d-flex mt-3 gap-2 flex-wrap justify-content-center">
        <img *ngFor="let img of productImages" [src]="img" class="thumbnail-image border rounded"
          [class.border-primary]="img === selectedImage" (click)="selectImage(img)" width="80" height="80"
          style="cursor: pointer; object-fit: cover;">
      </div>
    </div>

    <!-- Cột phải: thông tin sản phẩm -->
    <div class="col-md-6 mt-4 mt-md-0">
      <h2>{{ product.name }}</h2>
      <p><strong>Thương hiệu:</strong> {{ product.trademark }}</p>
      <p><strong>Giá:</strong> {{ product.price | number }} VNĐ </p>
      <p *ngIf="+(product.quantity ?? 0) > 0">
        <strong>Số lượng còn:</strong> {{ +product.quantity! }}
      </p>
      <p *ngIf="!(+product.quantity! > 0)" style="color: red; font-weight: bold;">
        Hết hàng
      </p>
      <!-- Số lượng -->
      <div class="input-group mb-3" style="max-width: 160px;">
        <button class="btn btn-outline-secondary" type="button" (click)="decreaseQuantity()">-</button>
        <input type="number" class="form-control text-center" [(ngModel)]="quantity" min="1">
        <button class="btn btn-outline-secondary" type="button" (click)="increaseQuantity()">+</button>
      </div>

      <!-- Nút hành động -->
      <div class="d-flex gap-2">
        <button class="btn btn-primary" (click)="addToCart()">Thêm vào giỏ hàng</button>
        <button class="btn btn-success" (click)="buyNow()">Mua ngay</button>
      </div>
    </div>
  </div>

  <!-- Mô tả chi tiết -->
  <div class="mt-5">
    <h3 class="mb-3">Thông số kỹ thuật</h3>
    <p class="product-description text-muted">{{ product.description }}</p>
  </div>
</div>

<app-footer></app-footer>